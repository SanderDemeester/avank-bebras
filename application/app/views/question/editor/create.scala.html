@(breadcrumbs : List[models.data.Link], question: models.question.Question)

@import models.EMessages
@import helper._
@import helper.twitterBootstrap._

@main("Question Editor", breadcrumbs) {
	<form id="saveQuestion">
		<div class="row-fluid">
			<div class="span3">

		    	<div class="well sidebar-nav">
				    <ul id="languages" class="nav nav-list">
						<li class="nav-header">Languages</li>
						<li class="divider"></li>
					    @for(language <- question.getLanguages()) {
						    <li class="languageItem"><span class="code hide">@language.getCode()</span><i class="icon-remove removelang"></i><a href="#" class="selectLang">@language.getName()</a></li>
						}
						
					</ul>
					<ul class="nav nav-list"><li class="divider"></li></ul>
					<div class="form-inline row-fluid">
						<div class="span9">
						<select id="languageList" class="span12">
							@for(language <- question.getNonLanguages()) {
								<option value="@language.getCode()">@language.getName()</option>
							}
						</select>
						</div>
						<button id="addLanguage" class="btn span3"><i class="icon-plus-sign"></i></button>
					</div>
				</div>
				
				<div class="well text-center">
					<button id="submit" class="btn btn-primary" type="button" data-loading-text="Loading..."><i class="icon-envelope icon-white"></i> Submit</button>
					<button id="export" class="btn" type="button" data-loading-text="Loading..."><i class="icon-download"></i> Export as .ZIP</button>
				</div>
		    
			</div>
			
			<div id="questionPanel" class="span9">
				<div id="alert" class="alert hide"></div>
				<div id="noPanelSelected" class="text-center"><span class="muted">Add a new language or select an existing one to get started.</span></div>
				@questionPanel(question, null)
				@for(language <- question.getLanguages()) {
					@questionPanel(question, language)
				}
			</div>
			
		</div>
		
		<!-- Hidden modal -->
		<div id="removeLanguageConfirm" class="modal hide fade">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    			<h3>Remove language</h3>
			</div>
			<div class="modal-body">
    			<p>Are you sure you want to remove the language <b id="removelang"></b>?</p>
    			<p>Once this language is deleted, there is no way to recover the content of this language of the question.</p>
  			</div>
  			<div class="modal-footer">
		    	<a data-dismiss="modal" href="#" class="btn">Cancel</a>
		    	<a id="confirmRemoveLang" href="#" class="btn btn-primary">Delete language</a>
		  	</div>
		</div>
		
		<!-- Hidden modal -->
		<div id="uploadFile" class="modal hide fade">
			<div class="modal-header">
				<button type="button" class="cancelUpload close" data-dismiss="modal" aria-hidden="true">&times;</button>
    			<h3>Upload file</h3>
			</div>
			<div class="modal-body">
				<small class="muted">These are your personal files that will be included into this question.
				They will be removed from the server after 24 hours.</small>
			
				<div id="uploadStatus"></div>
				
				<div id="dropzone" class="fade well">Drop files here</div>
    			<span class="muted">Or select a file manually:</span> <input id="fileupload" type="file" name="files[]" data-url="../upload" />
    			<div id="fileProgress" class="progress progress-striped active" style="display:none">
				    <div class="bar" style="width: 0%;"></div>
				</div>
				
				<hr />
				
				<table class="table table-striped">
					<thead>
						<tr>
							<th>Name</th>
							<th>Preview</th>
							<th>&nbsp;</th>
						</tr>
					</thead>
					<tbody id="files"></tbody>
				</table>
    			
  			</div>
  			<div class="modal-footer">
		    	<a data-dismiss="modal" href="#" class="cancelUpload btn">Cancel</a>
		  	</div>
		</div>
		
	    <!-- Load the page logic after everything else is loaded -->
	    <script type="text/javascript">var questionType = "@question.getType().name()";</script>
	    <script src="@routes.Assets.at("javascripts/questioneditor.js")" type="text/javascript"></script>
	</form>
}
