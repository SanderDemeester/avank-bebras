@(breadcrumbs : List[models.data.Link], questionForm: Form[models.question.editor.RawQuestion], questionType : String)

@import models.EMessages
@import models.question.editor.RawQuestion
@import helper._
@import helper.twitterBootstrap._

@main("Question Editor", breadcrumbs) {
	@helper.form(action = controllers.question.editor.routes.QuestionEditorController.save(), 'id -> "saveQuestion") {
		<div class="row-fluid">
			<div class="span3">

		    	<div class="well sidebar-nav">
				    <ul id="languages" class="nav nav-list">
						<li class="nav-header">Languages</li>
						<li class="divider"></li>
					    @repeat(questionForm("languages")) { language =>
					    	@if(language.value == "") {
						    	<li class="languageItem"><i class="icon-remove removelang"></i><a href="#" class="selectLang">@language.value</a></li>
							}
						}
						
					</ul>
					<ul class="nav nav-list"><li class="divider"></li></ul>
					<div class="form-inline row-fluid">
						<div class="span9">
						<select id="languageList" class="span12">
							@for(language <- RawQuestion.languageList) {
								<option value="@language.getCode()">@language.getCode()</option>
							}
						</select>
						</div>
						<button id="addLanguage" class="btn span3"><i class="icon-plus-sign"></i></button>
					</div>
				</div>
				
				<div class="well text-center">
					<button class="btn btn-primary" type="button"><i class="icon-envelope icon-white"></i> Submit</button>
					<button class="btn" type="button"><i class="icon-download"></i> Export as .ZIP</button>
				</div>
		    
			</div>
			
			<!-- Question panel template -->
			<div id="questionPanel" class="span9">
				<div id="noPanelSelected" class="text-center"><span class="muted">Add a new language or select an existing one to get started.</span></div>
				<div id="panelTemplate" class="questionFrame hide">
					<ul class="nav nav-tabs">
						<li><a class="tabGeneral" href="#answers" data-toggle="tab">General</a></li>
						<li><a class="tabAnswers" href="#answers" data-toggle="tab">Answers</a></li>
					  	<li><a class="tabIndex" href="#index" data-toggle="tab">Question</a></li>
					  	<li><a class="tabFeedback" href="#feedback" data-toggle="tab">Feedback</a></li>
					</ul>
					<div class="generalTab well hide">
						<h2>General</h2>
						<div class="form-inline">
							Title: <input type="text" class="title span10" placeholder="The title for this question in the current language."/>
						</div>
					</div>
					<div class="answersTab well hide">
						<h2>Answer</h2>
							<div class="input">
							@questionType match {
								case "MULTIPLE_CHOICE" => {
									@inputMultipleChoice(questionForm)
								}
								case "REGEX" => {
									@inputRegex(questionForm)
								}
							}
						</div>
					</div>
					<div class="indexTab well hide editorTab">
						<h2>Question</h2>
						<div class="muted">This page will be presented to the user when he has to solve this question.</div>
						<textarea rows="10" class="span12 editor" placeholder="Enter the question here.">&nbsp;</textarea>
					</div>
					<div class="feedbackTab well hide editorTab">
						<h2>Feedback</h2>
						<div class="muted">This content will be used to display feedback to the user after a competition.</div>
						<textarea rows="10" class="span12 editor" placeholder="Enter the question feedback here.">&nbsp;</textarea>
					</div>
				</div>
			</div>
		</div>
		
		<!-- Hidden modal -->
		<div id="removeLanguageConfirm" class="modal hide fade">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    			<h3>Remove language</h3>
			</div>
			<div class="modal-body">
    			<p>Are you sure you want to remove the language <b id="removelang"></b>?</p>
    			<p>Once this language is deleted, there is no way to recover the content of this language of the question.</p>
  			</div>
  			<div class="modal-footer">
		    	<a data-dismiss="modal" href="#" class="btn">Cancel</a>
		    	<a id="confirmRemoveLang" href="#" class="btn btn-primary">Delete language</a>
		  	</div>
		</div>
		
		<!-- Hidden modal -->
		<div id="uploadFile" class="modal hide fade">
			<div class="modal-header">
				<button type="button" class="cancelUpload close" data-dismiss="modal" aria-hidden="true">&times;</button>
    			<h3>Upload file</h3>
			</div>
			<div class="modal-body">
				<small class="muted">These are your personal files that will be included into this question.
				They will be removed from the server after 24 hours.</small>
			
				<div id="uploadStatus"></div>
				
				<div id="dropzone" class="fade well">Drop files here</div>
    			<span class="muted">Or select a file manually:</span> <input id="fileupload" type="file" name="files[]" data-url="../upload" />
    			<div id="fileProgress" class="progress progress-striped active" style="display:none">
				    <div class="bar" style="width: 0%;"></div>
				</div>
				
				<hr />
				
				<table class="table table-striped">
					<thead>
						<tr>
							<th>Name</th>
							<th>Preview</th>
							<th>&nbsp;</th>
						</tr>
					</thead>
					<tbody id="files"></tbody>
				</table>
    			
  			</div>
  			<div class="modal-footer">
		    	<a data-dismiss="modal" href="#" class="cancelUpload btn">Cancel</a>
		  	</div>
		</div>
		
	    <!-- Load the page logic after everything else is loaded -->
	    <script src="@routes.Assets.at("javascripts/questioneditor.js")" type="text/javascript"></script>
	}
}
